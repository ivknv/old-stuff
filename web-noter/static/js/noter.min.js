jQuery(document).ajaxSend(function(c,f,b){function a(g){var l=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var j=0;j<k.length;j++){var h=jQuery.trim(k[j]);if(h.substring(0,g.length+1)==(g+"=")){l=decodeURIComponent(h.substring(g.length+1));break}}}return l}function e(h){var j=document.location.host;var k=document.location.protocol;var i="//"+j;var g=k+i;return(h==g||h.slice(0,g.length+1)==g+"/")||(h==i||h.slice(0,i.length+1)==i+"/")||!(/^(\/\/|http:|https:).*/.test(h))}function d(g){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(g))}if(!d(b.type)&&e(b.url)){f.setRequestHeader("X-CSRFToken",a("csrftoken"))}});function load_page(a){if(a[0]=="/"){$.get(a,function(f){var b=$("<div/>").html(f);var e=b.find(".main");var c=b.find("title");$(".main").css("opacity","0.5");$(".main").html(e.html());$(".main").css("opacity","1");window.document.title=c.text();$.scrollTo("body");var d={url:a,title:c.text(),content:f};console.log(e.html());history.pushState(d,d.title,a);$("pre code").each(function(g,h){hljs.highlightBlock(h)})},"html")}else{window.href=a}}Array.prototype.contains=function(a){for(var b=0;b<this.length;b++){if(this[b]===a){return true}}return false};Array.prototype.unique=function(){var a=[];for(var b=0;b<this.length;b++){if(!a.contains(this[b])){a.push(this[b])}}return a};function placeTag(a){var b=$("input[name=tags]");var c=b.val();if(c[-1]==" "){c=c.slice(0,-1)+", "+a}else{if(c[-1]==","){c=c+" "+a}else{if(c){c=c+", "+a}else{c=a}}}b.val(c)}function getTags(c,b,a){$.post("/suggestedtags/",{id:c,text:b,title:a},function(e){var f=$(".suggested-tags");var d=[];f.empty();$.each(e.top3,function(h){if(e.top3[h][1][1][2].length>0){var g=e.top3[h][1][1][2]}$.each(g,function(j){if(g[j][0]==" "){g[j][0]=""}if(!d.contains(g[j])){d.push(g[j]);console.log(d);f.append("<button class='btn tag-btn' onclick='placeTag($(this).html());' type='button'>"+g[j]+"</button>")}})})},"json")}function rmNote(c){var b=function(e){if(e.success){var d=$("#note-"+c);d.fadeOut("slow");setTimeout('$("#note-'+c+'").remove()',1000);$result=$("#result");$result.addClass("alert-success");$result.css("display","block");$result.html('<strong class="success">Note was succesfully removed</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{fail()}};var a=$.post("/remove/",{id:c},b,"json");a.fail(rmNote_fail)}function rmNote_fail(){$result=$("#result");$result.addClass("alert-danger");$result.css("display","block");$result.html('<strong class="error">Failed to remove note</strong>');setTimeout('$result.fadeOut("slow")',1500)}function ask(b,a){$dialog=$(".remove-dialog");$dialog.css("display","block");$dialog.html('<button class="close" aria-hidden="true" data-dismiss="alert" type="button">x</button><h3>Are you sure?</h3><p>You\'re trying to remove \''+a+'\'</p><p><button id="proceed" class="btn">Proceed</button><button id="do-not-delete" class="btn">Do not delete</button></p>');$(".remove-dialog .close").click(function(c){$dialog.fadeOut("slow")});$(".remove-dialog #proceed").click(function(c){rmNote(b,rmNote_fail);$dialog.fadeOut("slow")});$(".remove-dialog #do-not-delete").click(function(c){$dialog.fadeOut("slow")})}function findChecked(){var b=$("#note").prop("checked"),a=$("#todo").prop("checked"),c=$("#snippet").prop("checked"),d=$("#warning").prop("checked");if(b){return"n"}else{if(a){return"t"}else{if(c){return"s"}else{if(d){return"w"}else{return"Unknown"}}}}}function edit_success(b){if(!(b.failed)){var a=$("#result");a.addClass("alert-success");a.css("display","block");a.html('<strong class="success">Note was successfully updated</strong>');setTimeout('$("#result").fadeOut("slow")',1500)}else{edit_fail()}}function edit_fail(){var a=$("#result");a.addClass("alert-danger");a.css("display","block");a.html('<strong class="error">Failed to update note</strong>');setTimeout('$("#result").fadeOut("slow")',1500)}function edit(f,e,d,b,c){var a=$.post("/update/",{id:f,title:e,text:d,tags:b,type:findChecked(),checked:c},edit_success,"json");a.fail(edit_fail)}function add_success(b){if(!(b.failed)){var a=$("#result");a.addClass("alert-success");a.css("display","block");a.html('<strong class="success">Note was successfully added</strong>');setTimeout('$("#result").fadeOut("slow")',1500)}else{add_fail()}}function add_fail(){var a=$("#result");a.addClass("alert-danger");a.css("display","block");a.html('<strong class="error">Failed to add note</string>');setTimeout('$("#result").fadeOut("slow")',1500)}function add(e,d,c,b){var a=$.post("/addnote/",{title:e,text:d,tags:c,todo:b},add_success,"json");a.fail(add_fail)}function addZero(a){return a>=0&&a<10?""+0+a:""+a}function escapeLtGt(a){return a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function preview(){$(".preview h2").html("Preview");$(".preview a > .title").html($(".col-6-md div input[name=title]").val());if($("#is_snippet").prop("checked")){$(".preview").attr("class","preview snippet");$(".preview .text").remove();if($(".preview pre").length<1){$(".preview").append("<pre><code></code></pre>")}$(".preview pre code").each(function(f,g){$(this).html(escapeLtGt($(".col-6-md div textarea[name=text]").val()));hljs.highlightBlock(g)})}else{if($(".preview .text").length<1){if($(".preview pre").length>0){$(".preview pre").remove()}$(".preview").append("<p class='text'></p>")}if($("#is_warning").prop("checked")){$(".preview").attr("class","preview warning")}else{$(".preview").attr("class","preview note")}$(".preview .text").html($(".col-6-md div textarea[name=text]").val().replace(/\n/gm,"<br/>").replace(/ /gm,"&nbsp;").replace(/\t/gm,"&nbsp;&nbsp;&nbsp;&nbsp;"))}var e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var a=["January","February","March","April","May","June","Jule","August","September","October","November","December"];var b=new Date(),c=e[b.getDay()],d=a[b.getMonth()];$(".preview .date").html(c+", "+d+" "+addZero(b.getDate())+" "+b.getFullYear()+" "+addZero(b.getHours())+":"+addZero(b.getMinutes()))}function preview1(a){$(".preview h2").html("Preview");$(".preview a > .title").html($(".col-6-md div input[name=title]").val());if($("#snippet").prop("checked")){$(".preview").attr("class","preview snippet");if($(".preview .text").length>0){$(".preview .text").remove()}if($(".preview pre").length<1){$(".preview").append("<pre><code></code></pre>")}$(".preview pre code").each(function(b,c){$(this).html(escapeLtGt($(".col-6-md div textarea[name=text]").val()));hljs.highlightBlock(c)})}else{if($(".preview .text").length<1){if($(".preview pre").length>0){$(".preview pre").remove()}$(".preview").append("<p class='text'></p>")}if($("#warning").prop("checked")){$(".preview").attr("class","preview warning")}else{$(".preview").attr("class","preview note")}$(".preview .text").html($(".col-6-md div textarea[name=text]").val().replace(/\n/gm,"<br/>").replace(/ /gm,"&nbsp;").replace(/\t/gm,"&nbsp;&nbsp;&nbsp;&nbsp;"))}$(".preview .date").html(a)}function handleEnter(){$(document).ready(function(){var a=$("input[name=tags]");a.keypress(function(b){if(b.which==13){load_page("/filter/"+a.val()+"/1/")}})})}function enableTab(b){var a=document.getElementById(b);a.onkeydown=function(d){if(d.keyCode===9){var f=this.value,g=this.selectionStart,c=this.selectionEnd;this.value=f.substring(0,g)+"\t"+f.substring(c);this.selectionStart=this.selectionEnd=g+1;return false}}};