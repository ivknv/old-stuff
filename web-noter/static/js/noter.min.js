jQuery(document).ajaxSend(function(c,f,b){function a(g){var l=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var j=0;j<k.length;j++){var h=jQuery.trim(k[j]);if(h.substring(0,g.length+1)==(g+"=")){l=decodeURIComponent(h.substring(g.length+1));break}}}return l}function e(h){var j=document.location.host;var k=document.location.protocol;var i="//"+j;var g=k+i;return(h==g||h.slice(0,g.length+1)==g+"/")||(h==i||h.slice(0,i.length+1)==i+"/")||!(/^(\/\/|http:|https:).*/.test(h))}function d(g){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(g))}if(!d(b.type)&&e(b.url)){f.setRequestHeader("X-CSRFToken",a("csrftoken"))}});function load_page(a){if(a[0]=="/"){$.get(a,function(f){var b=jQuery("<div/>").html(f);var e=b.find(".main");var g=jQuery(".main");var c=b.find("title");g.css("opacity","0.5");g.html(e.html());g.css("opacity","1");window.document.title=c.text();$.scrollTo("body");var d={url:a,title:c.text(),content:f};history.pushState(d,d.title,a);jQuery("pre code").each(function(h,j){hljs.highlightBlock(j)})},"html")}else{window.href=a}}Array.prototype.contains=function(a){for(var b=0;b<this.length;b++){if(this[b]===a){return true}}return false};Array.prototype.unique=function(){var a=[];for(var b=0;b<this.length;b++){if(!a.contains(this[b])){a.push(this[b])}}return a};function placeTag(a){var b=jQuery("input[name=tags]");var c=b.val();if(c[-1]==" "){c=c.slice(0,-1)+", "+a}else{if(c[-1]==","){c=c+" "+a}else{if(c){c=c+", "+a}else{c=a}}}b.val(c)}function getTags(c,b,a){$.post("/suggestedtags/",{id:c,text:b,title:a},function(e){var f=jQuery(".suggested-tags");var d=[];f.empty();$.each(e.top3,function(h){if(e.top3[h][1][1][2].length>0){var g=e.top3[h][1][1][2]}$.each(g,function(j){if(g[j][0]==" "){g[j][0]=""}if(!d.contains(g[j])){d.push(g[j]);f.append("<div class='tag-btn' onclick='placeTag(jQuery(this).html());' type='button'>"+g[j]+"</div>")}})})},"json")}function rmNote(c){var b=function(e){if(e.success){var d=jQuery("#note-"+c);d.fadeOut("slow");setTimeout('jQuery("#note-'+c+'").remove()',1000);$result=jQuery("#result");$result.addClass("okay");$result.css("display","block");$result.html('<strong class="success">Note was succesfully removed</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{fail()}};var a=$.post("/remove/",{id:c},b,"json");a.fail(rmNote_fail)}function rmNote_fail(){$result=jQuery("#result");$result.addClass("fail");$result.css("display","block");$result.html('<strong class="error">Failed to remove note</strong>');setTimeout('$result.fadeOut("slow")',1500)}function ask(c,a){var b=jQuery(".remove-dialog");b.css("display","block");b.html("<div class=\"close\">x</div><h3>Are you sure?</h3><p>You're trying to remove '"+a+'\'</p><p class=\'btns\'><div id="proceed" class="btn-success">Proceed</div><div id="do-not-delete" class="btn-success">Do not delete</div></p>');jQuery(".remove-dialog .close").click(function(d){b.fadeOut("slow")});jQuery(".remove-dialog #proceed").click(function(d){rmNote(c,rmNote_fail);b.fadeOut("slow")});jQuery(".remove-dialog #do-not-delete").click(function(d){b.fadeOut("slow")})}function findChecked(){var b=jQuery("#note").prop("checked"),a=jQuery("#todo").prop("checked"),c=jQuery("#snippet").prop("checked"),d=jQuery("#warning").prop("checked");if(b){return"n"}else{if(a){return"t"}else{if(c){return"s"}else{if(d){return"w"}else{return"Unknown"}}}}}function edit_success(a){if(!(a.failed)){$result=jQuery("#result");$result.addClass("okay");$result.css("display","block");$result.html('<strong class="success">Successfully updated note</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{edit_fail()}}function edit_fail(){$result=jQuery("#result");$result.addClass("fail");$result.css("display","block");$result.html('<strong class="error">Failed to update note</strong>');setTimeout('$result.fadeOut("slow")',1500)}function edit(f,e,d,b,c){var a=$.post("/update/",{id:f,title:e,text:d,tags:b,type:findChecked(),checked:c},edit_success,"json");a.fail(edit_fail)}function add_success(a){if(!(a.failed)){$result=jQuery("#result");$result.addClass("alert-success");$result.css("display","block");$result.html('<strong class="success">Note was successfully added</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{add_fail()}}function add_fail(){$result=jQuery("#result");$result.addClass("alert-danger");$result.css("display","block");$result.html('<strong class="error">Failed to add note</string>');setTimeout('$result.fadeOut("slow")',1500)}function add(e,d,c,b){var a=$.post("/addnote/",{title:e,text:d,tags:c,todo:b},add_success,"json");a.fail(add_fail)}function addZero(a){return a>=0&&a<10?""+0+a:""+a}function escapeLtGt(a){return a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function replaceNewLines(a){return a.replace(/\n/gm,"<br/>").replace(/ /gm,"&nbsp;").replace(/\t/gm,"&nbsp;&nbsp;&nbsp;&nbsp;")}function preview(){var c=jQuery(".preview"),i=c.find(".text"),h=c.find("pre code"),j=c.find("pre"),g=jQuery("input[name=title]"),d=jQuery("textarea[name=text]");c.find("h2").html("Preview");c.find("a > .title").html(g.val());if(jQuery("#is_snippet").prop("checked")){c.attr("class","preview snippet");i.remove();if(j.length<1){c.append("<pre><code></code></pre>")}h.each(function(l,m){jQuery(this).html(escapeLtGt(d.val()));hljs.highlightBlock(m)})}else{if(i.length<1){if(j.length>0){j.remove()}c.append("<p class='text'></p>")}if(jQuery("#is_warning").prop("checked")){c.attr("class","preview warning")}else{c.attr("class","preview note")}i.html(replaceNewLines(d.val()))}var k=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var b=["January","February","March","April","May","June","Jule","August","September","October","November","December"];var a=new Date(),e=k[a.getDay()],f=b[a.getMonth()];jQuery(".preview .date").html(e+", "+f+" "+addZero(a.getDate())+" "+a.getFullYear()+" "+addZero(a.getHours())+":"+addZero(a.getMinutes()))}function preview1(g){var f=jQuery(".preview"),b=f.find(".text"),c=jQuery("input[name=title]"),i=jQuery("textarea[name=text]"),h=f.find("pre"),a=h.find("code"),e;f.find("h2").html("Preview");f.find("a > .title").html(c.val());if(jQuery("#snippet").prop("checked")){f.attr("class","preview snippet");if(b.length>0){b.remove()}if(h.length<1){f.append("<pre><code></code></pre>")}a.each(function(d,j){jQuery(this).html(escapeLtGt(i.val()));hljs.highlightBlock(j)})}else{if(b.length<1){if(h.length>0){h.remove()}f.append("<p class='text'></p>")}if(jQuery("#warning").prop("checked")){f.attr("class","preview warning")}else{f.attr("class","preview note")}b.html(replaceNewLines(i.val()))}f.find(".date").html(g)}function handleEnter(){jQuery(document).ready(function(){var a=jQuery("input[name=tags]");a.keypress(function(b){if(b.which==13){load_page("/filter/"+a.val()+"/1/")}})})}function enableTab(b){var a=document.getElementById(b);a.onkeydown=function(d){if(d.keyCode===9){var f=this.value,g=this.selectionStart,c=this.selectionEnd;this.value=f.substring(0,g)+"\t"+f.substring(c);this.selectionStart=this.selectionEnd=g+1;return false}}};