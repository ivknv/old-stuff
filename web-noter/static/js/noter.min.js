jQuery(document).ajaxSend(function(c,f,b){function a(g){var l=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var j=0;j<k.length;j++){var h=jQuery.trim(k[j]);if(h.substring(0,g.length+1)==(g+"=")){l=decodeURIComponent(h.substring(g.length+1));break}}}return l}function e(h){var j=document.location.host;var k=document.location.protocol;var i="//"+j;var g=k+i;return(h==g||h.slice(0,g.length+1)==g+"/")||(h==i||h.slice(0,i.length+1)==i+"/")||!(/^(\/\/|http:|https:).*/.test(h))}function d(g){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(g))}if(!d(b.type)&&e(b.url)){f.setRequestHeader("X-CSRFToken",a("csrftoken"))}});function load_page(a,b){if(a[0]=="/"){$indicator=jQuery("#progress-indicator");$indicator.attr("style","");$indicator.css("background-color","white");$indicator.css("display","block");$indicator.animate({width:"40%"},450);$indicator.css("background-color","rgb(0, 180, 0)");var c=$.get(a,function(j){var k=jQuery(".main");var e=jQuery("<div/>").html(j);var i=e.find(".main");var g=e.find("title");var f=/#.+$/;window.document.title=g.text();$indicator.animate({width:"100%"},250,function(){$indicator.attr("style","")});k.html(i.html());var d=a.match(f);if(d!=null&&d.length>0&&d[0].length>0){jQuery.scrollTo(d[0])}else{jQuery.scrollTo("body")}var h={url:a,title:g.text(),content:j};history.pushState(h,h.title,a);jQuery("pre code").each(function(l,m){hljs.highlightBlock(m)})},"html");c.fail(function(){$indicator.css("background-color","red");$indicator.animate({width:"100%"},700,function(){$indicator.attr("style","")})});if(b){c.done(function(){jQuery("input[name=tags]").focus()})}}else{window.href=a}}Array.prototype.contains=function(a){for(var b=0;b<this.length;b++){if(this[b]===a){return true}}return false};Array.prototype.unique=function(){var a=[];for(var b=0;b<this.length;b++){if(!a.contains(this[b])){a.push(this[b])}}return a};function placeTag(a){var b=jQuery("input[name=tags]");var c=b.val();if(c[-1]==" "){c=c.slice(0,-1)+", "+a}else{if(c[-1]==","){c=c+" "+a}else{if(c){c=c+", "+a}else{c=a}}}b.val(c);b.focus()}function getTags(c,b,a){$.post("/suggestedtags/",{id:c,text:b,title:a},function(e){var f=jQuery(".suggested-tags");var d=[];f.empty();$.each(e.top3,function(h){if(e.top3[h][1][1][2].length>0){var g=e.top3[h][1][1][2]}$.each(g,function(j){if(g[j][0]==" "){g[j][0]=""}if(!d.contains(g[j])){d.push(g[j]);f.append("<div class='tag-btn' onclick='placeTag(jQuery(this).html());' type='button'>"+g[j]+"</div>")}})})},"json")}function rmNote(c){var b=function(e){if(e.success){var d=jQuery("#note-"+c);d.fadeOut("slow");setTimeout('jQuery("#note-'+c+'").remove()',1000);$result=jQuery("#result");$result.addClass("okay");$result.css("display","block");$result.html('<strong class="success">Succesfully removed</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{fail()}};var a=$.post("/remove/",{id:c},b,"json");a.fail(rmNote_fail)}function rmNote_fail(){$result=jQuery("#result");$result.addClass("fail");$result.css("display","block");$result.html('<strong class="error">Failed to remove note</strong>');setTimeout('$result.fadeOut("slow")',1500)}function ask(c,a){var b=jQuery(".remove-dialog");b.css("display","block");b.html("<div class=\"close\">x</div><h3>Are you sure?</h3><p>You're trying to remove '"+a+'\'</p><p class=\'btns\'><div id="proceed" class="btn-success">Proceed</div><div id="do-not-delete" class="btn-success">Do not delete</div></p>');jQuery(".remove-dialog .close").click(function(d){b.fadeOut("slow")});jQuery(".remove-dialog #proceed").click(function(d){rmNote(c,rmNote_fail);b.fadeOut("slow")});jQuery(".remove-dialog #do-not-delete").click(function(d){b.fadeOut("slow")})}function findChecked(){var b=jQuery("#note").prop("checked"),a=jQuery("#todo").prop("checked"),c=jQuery("#snippet").prop("checked"),d=jQuery("#warning").prop("checked");if(b){return"n"}else{if(a){return"t"}else{if(c){return"s"}else{if(d){return"w"}else{return"Unknown"}}}}}function edit_success(a){if(!(a.failed)){$result=jQuery("#result");$result.attr("class","okay");$result.css("display","block");$result.html('<strong class="success">Successfully updated note</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{edit_fail()}}function edit_fail(){$result=jQuery("#result");$result.attr("class","fail");$result.css("display","block");$result.html('<strong class="error">Failed to update note</strong>');setTimeout('$result.fadeOut("slow")',1500)}function edit(f,e,d,b,c){var a=$.post("/update/",{id:f,title:e,text:d,tags:b,type:findChecked(),checked:c},edit_success,"json");a.fail(edit_fail)}function add_success(a){if(!(a.failed)){$result=jQuery("#result");$result.addClass("alert-success");$result.css("display","block");$result.html('<strong class="success">Note was successfully added</strong>');setTimeout('$result.fadeOut("slow")',1500)}else{add_fail()}}function add_fail(){$result=jQuery("#result");$result.addClass("alert-danger");$result.css("display","block");$result.html('<strong class="error">Failed to add note</string>');setTimeout('$result.fadeOut("slow")',1500)}function add(e,d,c,b){var a=$.post("/addnote/",{title:e,text:d,tags:c,todo:b},add_success,"json");a.fail(add_fail)}function addZero(a){return a>=0&&a<10?""+0+a:""+a}function escapeLtGt(a){return a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function replaceNewLines(a){return a.replace(/\n/gm,"<br/>").replace(/\t/gm,"&nbsp;&nbsp;&nbsp;&nbsp;")}function anti_XSS(a){a.val(a.val().replace(/<[ \t]*script[ \t]*.*?>.*<[ \t]*\/[ \t]*script[ \t]*>/gim,"").replace(/<[ \t]*script[ \t]*.*?>.*/gim,""))}function preview(){var d=jQuery(".preview"),j=d.find(".text"),i=d.find("pre code"),k=d.find("pre"),h=jQuery("input[name=title]"),e=jQuery("textarea[name=text]");d.find("h2").html("Preview");d.find("a > .title").html(h.val());if(jQuery("#is_snippet").prop("checked")){d.attr("class","preview snippet");j.remove();if(k.length<1){d.append("<pre><code></code></pre>")}d.find("pre code").each(function(m,n){jQuery(this).html(escapeLtGt(e.val()));hljs.highlightBlock(n)})}else{anti_XSS(e);if(j.length<1){if(k.length>0){k.remove()}d.append("<p class='text'></p>")}if(jQuery("#is_warning").prop("checked")){d.attr("class","preview .warning")}else{d.attr("class","preview .note")}d.find(".text").html(replaceNewLines(e.val()))}d.find("a > .title").html(escapeLtGt(h.val()));var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var c=["January","February","March","April","May","June","Jule","August","September","October","November","December"];var b=new Date(),f=l[b.getDay()],g=c[b.getMonth()];var a=d.find(".date > time");a.html(f+", "+g+" "+addZero(b.getDate())+" "+b.getFullYear()+" "+addZero(b.getHours())+":"+addZero(b.getMinutes()));a.attr("datetime",b)}function preview1(f){var e=jQuery(".preview"),b=e.find(".text"),c=jQuery("input[name=title]"),i=jQuery("textarea[name=text]"),h=e.find("pre"),a=h.find("code");e.find("h2").html("Preview");e.find("a > .title").html(c.val());if(jQuery("#snippet").prop("checked")){e.attr("class","preview snippet");if(b.length>0){b.remove()}if(h.length<1){e.append("<pre><code></code></pre>")}e.find("pre code").each(function(d,j){jQuery(this).html(escapeLtGt(i.val()));hljs.highlightBlock(j)})}else{anti_XSS(i);if(b.length<1){if(h.length>0){h.remove()}e.append("<p class='text'></p>")}if(jQuery("#warning").prop("checked")){e.attr("class","preview warning")}else{e.attr("class","preview note")}e.find(".text").html(replaceNewLines(i.val()))}e.find("a > .title").html(escapeLtGt(c.val()));var g=e.find(".date > time");g.attr("datetime",f);g.html(f)}function handleEnter(a){jQuery(document).ready(function(){var b=jQuery("input[name=tags]");b.keypress(function(c){if(c.which==13){load_page("/filter"+a+"/"+b.val())}})})}jQuery(document).keypress(function(a){if(!(jQuery(a.target).is("input, textarea"))){switch(a.which){case 49:case 104:load_page("/");break;case 50:case 97:load_page("/add/");break;case 51:case 109:load_page("/manage/");break;case 52:case 102:load_page("/filter/");break;case 115:jQuery("input[name=q]").focus();break;case 35:if(window.location.pathname.startsWith("/filter")){jQuery.scrollTo("body");jQuery("input[name=tags]").focus()}else{load_page("/filter/",true)}break;case 110:jQuery("#next").trigger("click");break;case 112:jQuery("#previous").trigger("click");break;case 101:jQuery(".edit_button").trigger("click");break;default:break}}});function enableTab(b){var a=document.getElementById(b);a.onkeydown=function(d){if(d.keyCode===9){var f=this.value,g=this.selectionStart,c=this.selectionEnd;this.value=f.substring(0,g)+"\t"+f.substring(c);this.selectionStart=this.selectionEnd=g+1;return false}}}$(document).ready(function(){var a=$("input[name=q]");a.keypress(function(b){if(b.which==13){load_page("/search/"+a.val())}});$(window).on("popstate",function(c){var d=c.originalEvent.state;if(!d){return}else{var b=document.open("text/html","");b.write(d.content);b.close()}})});function PlaceReadMoreButtons(){jQuery(document).ready(function(){var a=$("article");a.each(function(c,f){var d=$(this).find(".text");if(parseInt(d.css("height"))>210){d.addClass("cut");var b=$(this).find("a").attr("href");$(this).append("<a href='"+b+"' onclick='load_page(\""+b+"\"); return false;'><div class='read-more-btn'>Continue reading</div></a>")}})})}function antiEscapeLtGt2(a){return a.replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&amp;lt;/gm,"&lt;").replace(/&amp;gt;/gm,"&gt;").replace(/&amp;/gm,"&")}function onLoad(){jQuery(document).ready(function(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("chrome")>-1||a.indexOf("applewebkit")>-1||a.indexOf("presto")>-1){jQuery(".filter-btn").css("line-height","1.5");jQuery(".search-btn").css("line-height","1.75");jQuery(".input-field").css("margin-top","4px");jQuery(".label").css("padding-bottom","3px")}jQuery("article .text").each(function(){jQuery(this).html(antiEscapeLtGt2(jQuery(this).html()))})})}hljs.configure({tabReplace:"    "});hljs.initHighlightingOnLoad();function fail(a){function b(c){$result=jQuery("#result");$result.attr("class","fail");$result.html("<strong class='error'>"+a+"</strong>");$result.css("display","block");setTimeout("$result.fadeOut('slow')",1500)}return b}function success(a){function b(c){if(c.success){$result=jQuery("#result");$result.attr("class","okay");$result.html("<strong class='success'>"+a+"</strong>");$result.css("display","block");setTimeout("$result.fadeOut('slow')",1500);if(c.eid&&c.result){jQuery(c.eid).html(c.result)}}else{fail("Some kind of error")(c)}}return b}function update_first_name(c,b){var a=jQuery.post("/update-firstname/",{id:c,new_first_name:b},success("First name updated","#"),"json");a.error(fail("Some kind of error"))}function update_last_name(c,b){var a=jQuery.post("/update-lastname/",{id:c,new_last_name:b},success("Last name updated"),"json");a.error(fail("Some kind of error"))}function update_username(c,b){var a=jQuery.post("/update-username/",{id:c,new_username:b},function(d){success("Username updated")(d);if(d.success){document.title=b+"'s profile - Noter"}},"json");a.error(fail("Some kind of error"))}function update_password(e,c,d,b){var a=jQuery.post("/update-password/",{id:e,new_password:d,current_password:c,confirm_password:b},success("Password updated"),"json");a.error(fail("Some kind of error"))};